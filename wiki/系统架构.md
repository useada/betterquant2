### 概述
&emsp;&emsp;BetterQuant目前采用的是微服务架构，专注于量化交易策略的执行和风险管理。系统充分考虑了灾难恢复，使用了时序数据库来保存行情信息。核心目标是为交易员提供可靠、高效的交易环境，并允许快速开发和部署新的交易策略。  

&emsp;&emsp;BetterQuant将整个系统划分为多个独立的服务，每个服务都是一个独立的业务单元。主要的微服务包括策略引擎、算法交易引擎、交易服务、交易网关、行情网关、风控子系统、仓位管理和订单管理。这样的架构提高了系统的可扩展性和可维护性。  

&emsp;&emsp;BetterQuant使用时序数据库来保存市场行情数据。时序数据库具有高效的时间序列数据存储和查询能力，适用于处理大量的行情数据。除时序数据库外，系统还使用MySQL作为传统的关系型数据库，用于存储如用户信息、交易配置、委托和成交信息等等。   

&emsp;&emsp;交易系统的所有数据包括以下方面：首先是前面提到的行情数据，这都保存在了时序数据库中，然后是保存在mysql中的一些基本信息和交易数据（成交回报和委托回报），除了上述数据之外，还有金工的交易策略在运行期间都会有一些中间数据需要保存下来，以便下次启动的时候恢复状态或者其他用途，每个交易策略需要保存的数据都不尽相同，BetterQuant巧妙利用了POSIX的tmpfs，允许用户将要保存的数据存放在内存映射的一个目录上，用最简单的办法实现了这个需求并确保了策略运行的性能。  

### 子系统
&emsp;&emsp;BetterQuant主要包含以下子系统：  

* 策略引擎  
策略开发人员可以通过策略引擎这个基础库提供的接口，利用这些接口实现各种各样的交易策略，当然策略引擎并不只是一个用来实现交易策略的基础库，同时他还是一个异步的并行任务处理框架，还可以通过它来实现一些非交易策略，比如监控策略等等。

* 算法交易引擎  
为策略引擎提供算法单功能，算法交易引擎抽象提取了算法交易通用部分代码，在此基础上以后快速的实现各种算法单功能，目前系统已经内置实现了TWAP拆单算法。

* 交易服务  
接受交易策略报单，对订单进行预处理（开平转换和净头寸管理），根据配置启动和创建风控模组组合，风控模组主要负责处理各种维度的事前风控。

* 交易网关  
与交易所连接，接受来自交易服务的报单指令，并将其转换为柜台可接受的格式并发送。

* 行情网关  
从交易所获取实时行情数据，并将其提供给策略引擎进行分析。

* 风控子系统  
实时监控交易风险，风控子系统主要负责事中风控，例如实时计算各个维度的已实现和未实现盈亏信息等等。  

* 仓位管理  
跟踪和管理所有交易策略的仓位信息，确保准确控制资金分配和风险控制，这是一个通用模块策略引擎、交易服务、交易网关都会用它来管理仓位。  

* 订单管理  
主要是管理和跟踪在途订单和最近完结的若干币订单的状态和信息，这是一个通用模块策略引擎、交易服务、交易网关都会用到它。  

### 系统架构图

![image](https://github.com/byrnexu/bq/assets/24740973/23772694-36fa-4918-a03e-0b5433345b32)


